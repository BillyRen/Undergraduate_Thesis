\chapter{Data Matrix快速定位算法研究}
\section{主要思路}
快速定位算法设计的一个要点是：快。经过分析和实验对比，选择能够满足条件的最快速算法。在图像处理领域，一般来说，效果与速度难以兼顾，效果好的算法往往计算量比较大，耗时较长，快速算法在复杂环境下往往效果不好，对噪声等情况的抑制不够理想。在快速算法设计过程中，不断地进行对比测试就显得十分必要。

在算法设计中，我采取了“分而治之，逐个击破”的策略。首先设计一个大致的算法框架，然后对每一个步骤的算法进行优化。对于可能的方案，进行单元测试，优化参数。比如，在二值化过程中，可供选择的二值化算法有Otsu法，自适应阈值法等。其中Otsu法是比较普遍使用的，可以同时兼顾效果和速度。但是在实验过程中，我发现，Otsu法不能很好的处理光照分布不均匀，存在阴影的情况。在这种情况下，选择自适应阈值能够取得比较好的效果。但是自适应阈值处理时间较慢，在普通情况下Otsu法已经可以满足下一步处理的需求。因此，我在设计中加入了自动选择算法的功能，如果发现Otsu法不能为下一步识别提供必要的信息，算法会重新调用自适应算法重新处理。这样同时兼顾了定位速度与定位效果。具体的粗定位实现效果会在下文中详加介绍。

在定位方法上，考虑到速度限制，我没有采用传统的Hough直线检测，而是直接对连通域进行矩形识别，通过加入阈值限制的方法来提取出可能存在二维码的ROI。通过实验，发现这种方法极大地提高了定位速度，并且能够很好的对多条码区域进行提取，具有很好的可拓展性。

整个算法的流程图如图（\ref{fig:flowchart}）所示：

\begin{figure}[htbp]
\begin{center}
	\includegraphics[width=0.8\linewidth]{flowchart.png}
\end{center}
\caption{快速定位算法流程图}
\label{fig:flowchart}
\end{figure}

整个定位过程分成两部分：粗定位和精确定位。粗定位输入信息是原始图像，输出是所有可能包含二维码的矩形区域。精确定位接受粗定位过程的输出信息，输出是在原始图像上标记所有二维条码的精确边界。

\section{粗定位算法}
读取进图像后，首先对图像进行缩放处理。这样一方面可以减少数据量，提高处理速度，另一方面也使得程序可以处理多种尺寸的图像。同时，由于在图像尺寸压缩过程中带来的信息损失，这在一定程度上也起到了降噪的作用。接下来对图像进行二值化操作，默认采取的是Otsu法，适用于绝大多数的场景，如果碰到光照分布不均出现阴影的情况，会自动调用自适应阈值算法。接下来进行形态学上腐蚀处理，这一过程的目的在于将二维码区域填充起来。经过腐蚀的图像会进行连通域标记，将整个图像划分成包含不同形状的连通域。通过阈值对所有连通域进行过滤，可以很好的提取出二维条码所在连通域。

\begin{figure}
\begin{center}
\subfloat[输入图像]{
\includegraphics[width=0.5\textwidth]{dmc.png}}
\subfloat[连通域]{
\includegraphics[width=0.5\linewidth]{dmc_label.png}}\\
\subfloat[连通域定位]{
\includegraphics[width=0.5\textwidth]{dmc_label_locate.png}}
\subfloat[输出图像]{
\includegraphics[width=0.5\textwidth]{0_1.png}}
\end{center}
\caption{粗定位效果}
\label{fig:region_locate}
\end{figure}

关于阈值的选择，在样本较少时，可以手动进行测试调整。对于以后大规模在工业上部署使用，可以选择合适的消费函数，进行计算机自动优化。实现方法如下：首先人工定位条码精确边界，作为训练数据。计算机自动选择不同阈值，测试成功定位的条目数。优化结束后，在识别过程中，阈值也会随着识别的准确率进行动态微调。

\section{精确定位算法}
粗定位过程中会生成包含二维条码的区域，精确定位会对这些区域进行更进一步的处理。由于粗定位过程中已经排除了大部分不含二维码的区域，因此在精确定位过程中需要处理的数据量已经小了很多。这进一步提升了定位速度。

在精确定位的第一步，首先会进行边缘检测。同二值化过程的处理方法一样，在边缘检测时同样整合了多个算法，可以进行自动选择。默认使用的是Roberts算子，这是最简单也是最快速的边缘检测算法。如果Roberts算法不能很好的定期条码边界，程序会自动调用Canny算子重新进行检测。这种多算法自动选择的方法，虽然在处理复杂环境时会多花一些时间，但是在绝大多数时间采用的都是非常迅速的算法，同时也兼顾了对环境的适应性。

在进行完边缘检测后，接下来会进行形态学膨胀过程。通过这一过程，二维条码内部绝大部分区域会被重新填充。接下来的过程会把该区域当做一个连通域进行处理，这可以防止定位时出现的错误。比起边缘检测算法等其他过程，形态学处理相对耗时较长，因此在这个过程中进行优化就十分必要。主要的步骤是选择合适的结构元素，在保证能够将条码内部填充的前提下，尽可能选择简单而面积小的结构元素对提升定位速度有很大的帮助。

\begin{figure}
\begin{center}
\subfloat[边缘检测图像]{
\includegraphics[width=0.5\textwidth]{dmc_roberts.png}}
\subfloat[形态学膨胀]{
\includegraphics[width=0.5\linewidth]{dmc_roberts_dilate.png}}
\end{center}
\caption{形态学膨胀效果}
\label{fig:dilate}
\end{figure}
%接下来的步骤：四边形识别

%\section{OpenCV实现}
\section{实验结果}
经过实验，该快速定位算法能够很好的处理噪声、阴影、模糊、光照过强/过暗、旋转、倾斜等复杂环境。定位效果如图(\ref{fig:result1})和图（\ref{fig:result2}）所示。

\begin{figure}
\begin{center}

\subfloat[普通图像]{
\includegraphics[width=0.5\textwidth]{0.png}}
\subfloat[普通图像]{
\includegraphics[width=0.5\linewidth]{0_1.png}}\\

\subfloat[倾斜]{
\includegraphics[width=0.5\textwidth]{1.png}}
\subfloat[倾斜]{
\includegraphics[width=0.5\linewidth]{1_1.png}}\\

\subfloat[形变]{
\includegraphics[width=0.5\textwidth]{2.png}}
\subfloat[形变]{
\includegraphics[width=0.5\linewidth]{2_1.png}}\\

\subfloat[旋转]{
\includegraphics[width=0.5\textwidth]{7.png}}
\subfloat[旋转]{
\includegraphics[width=0.5\linewidth]{7_1.png}}

\end{center}
\caption{快速算法定位效果(1/2)}
\label{fig:result1}
\end{figure}

\begin{figure}
\begin{center}

\subfloat[高亮度]{
\includegraphics[width=0.5\textwidth]{5.png}}
\subfloat[高亮度]{
\includegraphics[width=0.5\linewidth]{5_1.png}}\\

\subfloat[低亮度]{
\includegraphics[width=0.5\textwidth]{4.png}}
\subfloat[低亮度]{
\includegraphics[width=0.5\linewidth]{4_1.png}}\\

\subfloat[模糊]{
\includegraphics[width=0.5\textwidth]{6.png}}
\subfloat[模糊]{
\includegraphics[width=0.5\linewidth]{6_1.png}}\\

\subfloat[噪声]{
\includegraphics[width=0.5\textwidth]{8.png}}
\subfloat[噪声]{
\includegraphics[width=0.5\linewidth]{8_1.png}}\\

\end{center}
\caption{快速算法定位效果(2/2)}
\label{fig:result2}
\end{figure}

在复杂度非常高背景下，该算法也有着不错的表现，如图（\ref{fig:complex}）所示。

\begin{figure}
\begin{center}
\subfloat[输入图像]{
\includegraphics[width=0.5\textwidth]{11.png}}
\subfloat[定位效果]{
\includegraphics[width=0.5\linewidth]{11_1.png}}
\end{center}
\caption{复杂环境定位效果}
\label{fig:complex}
\end{figure}

最后，我测试了该算法在极为复杂的工业环境中的表现，如图（\ref{fig:industry}）所示。

\begin{figure}
\begin{center}
\subfloat[输入图像]{
\includegraphics[width=0.5\textwidth]{9.png}}
\subfloat[定位效果]{
\includegraphics[width=0.5\linewidth]{9_1.png}}
\end{center}
\caption{工业环境定位效果}
\label{fig:industry}
\end{figure}

\chapter{总结}
\section{工作总结}
本文主要从图像处理的角度出发，研究了二维码识别相关领域技术，提出了具有高容错性的快速定位算法。本文主要解决了如下几个问题：

（1）二维条码的粗定位

利用二维码本身是矩形的特点，在预处理之后采用连通域标记的方法提取出可能存在二维码的潜在区域。该技术使得二维码识别可以应用于各种复杂工业环境下，极大的扩大了二维码识别技术的应用范围。

（2）二维条码的精确定位
本文没有采用传统的直线检测定位方法，而是直接运用四边形检测。这种创新性方法将定位速度成倍提高，是本算法成功的关键之处。同时，该方法同样适用于复杂环境，完全满足工业上使用条件。

（3）对二维条码识别技术进行研究
二维码识别相关技术包括图像二值化、边缘检测、图像去噪、图像校正和形态学处理等多种图像处理方法。本文对相关领域已有的算法进行了比较和优化，构造出快速定位算法。

\section{研究展望}
二维条码具有许多优点：密度高、容量大、纠错能力强、可表示文字图像信息、可加密等。现在二维码已经广泛应用于现代自动化生产线、医疗行业、商品管理系统、超市物流管理等各个领域。随着物联网概念的推广和发展，将来二维码势必将在未来的商业和社会中扮演越来越重要的角色。

Data Matrix码由于其编码特点，可以在最小的空间内储存最多的信息。同时，比起其他二维码，它更适合在各种产品表面直接印刷。因此，Data Matrix码在工业流水线上有着十分重要的作用。但是，相比去QR码，Data Matrix码的识别更加困难，现在已有的识别算法中，识别Data Matrix码的速度远远慢于QR码。这已经成为了限制生产效率的瓶颈之一。今后势必会有更多的有关快速定位算法的研究。

同时，由于工业上的复杂环境给二维码识别带来的挑战，如何在提升定位速度环境下同时兼容复杂环境识别能力也是对研究者提出的新挑战。广阔的前景与简单的挑战并存，这对研究二维码技术的广大科研人员既是挑战也是动力。






\iffalse
\chapter{表格、图片和公式}
\section{数学公式}
这一部分列举了一些常用公式和数学符号的在\LaTeX中的表示方法。

常用数学符号：

$\{(\mathbf{x_i},l_i),i=1,2,...,n\}$

$\mathbf{x_i}\in \Re ^d$

$\mathbf{c}=[c_1,c_2,...,c_n]^T$

$\left \lVert c \right \rVert_0$

$\left \lVert \mathbf{v} \right \rVert_p = (\sum_i |v_i|^p)^{1/p}$

$\int_{0}^{\infty}f(t\mid\alpha,\beta)dt$

\vskip 20pt

最一般的公式：
\begin{equation}
\label{eq:orginal}
\mathbf{y}=c_1\mathbf{x_1}+c_2\mathbf{x_2}+...+c_n\mathbf{x_n}
\end{equation}

\begin{equation}
\label{eq:spareserep}
c=\mathop{\mathrm{min}}\limits_{c'\in\Re^n} \left \lVert c' \right \rVert_0, \quad \text{subject to} \quad \mathbf{y}=Ac
\end{equation}

\vskip 20pt

需要分两行或多行显示的公式：
\begin{equation}
\begin{array}{l}
g(\mathbf{x})=-8.2+0.031\text{Age}+0.013\text{HR}-0.35\text{Albumin}+0.042\text{ALP}\\
\quad \quad \quad -0.015\text{AST}+0.389\text{Ratio}-0.009\text{PaO2}+0.395\text{FiO2}\\
\end{array}
\end{equation}

\vskip 20pt

多个方程，使用同一个编号：
\begin{equation}\label{eq:definefeature}
   \begin{array}{l}
\text{if \quad}  \bar{v} \le v_2 \text{\quad and \quad} \underline{v} \ge v_1, \text{\quad then \quad} v=0;\\
\text{else \quad} v=\text{max}\{\bar{v}-v_2,v_1-\underline{v}\}
\end{array}
\end{equation}

带大括号的方程：
\begin{equation}
\left\{
\begin{aligned}
    \frac{\partial(\log L(\alpha,\beta))}{\partial \alpha}&=0  \\
    \frac{\partial(\log L(\alpha,\beta))}{\partial \beta}&=0   \\
\end{aligned}
\right.
\end{equation}

矩阵形式的方程：
\begin{displaymath}
E[(\hat{\tilde{x}}-E[\hat{\tilde{x}}])  {(\hat{\tilde{x}}-E[\hat{\tilde{x}}])}^T]=
\begin{bmatrix}
\mathbf{P}_{{x_k}{x_k}}  & \mathbf{P}_{{x_k}{w_k}}\\
\mathbf{P}_{{w_k}{x_k}} &  \mathbf{P}_{{w_k}{w_k}}
\end{bmatrix}
\end{displaymath}

\section{表格}
普通的表格（\ref{tab:modelprocess}和\ref{tab:normal}）：
\begin{table}
\begin{center}
\begin{tabular}{@{}cc@{}} \toprule
序号 \quad \quad & 内容\\
\midrule	
1	&准确定义评估系统关注的结果\\
\midrule
2	&定义可能的预测变量\\
\midrule
3	&数据收集\\
\midrule
4	&单变量分析（$\chi ^2$检验，学生$t$检验）\\
\midrule
\bottomrule
\end{tabular}
\end{center}
\caption{普通的表格A}
\label{tab:modelprocess}
\end{table}

\begin{table}[htbp]
\begin{center}
\begin{tabular}{cc| cc} \toprule
生理量（单位） \quad  & 参考值 &生理量（单位） \quad & 参考值\\
\hline
HR（bpm） & $70 \sim 109$ & SysABP（mmHg） & $80 \sim 149$ \\
\hline
Temp（\textcelsius） & $36 \sim 38.4$ & BUN（mg/mL） & $9.8 \sim 20.7$\\
\hline
RespRate（bpm）& $12 \sim 24$ & PaO2/FiO2（mmHg）& $>300$ \\
\bottomrule
\end{tabular}
\end{center}
\caption{普通的表格B}
\label{tab:normal}
\end{table}

可以用作流程图的表格（\ref{tab:SpareseRep}）：
\begin{table}
\begin{center}
\begin{tabular}{@{}ccc@{}} \toprule
\bf{Inputs:} \quad  & $ \{(\mathbf{x_i},l_i);i=1,...,n \} $ and $\mathbf{y} $ \\
1 & $\mathbf{x_i}$和$\mathbf{y}$的归一化  \\
2 & 构造矩阵$A$  \\
3 & 解优化问题\\
4 &	计算 $g_k(\mathbf{y}),k=0,1$	\\
\bf{Output:} \quad & arg $\mathop{\mathrm{min}}\limits_{k} g_k(\mathbf{y}) $\\
\bottomrule
\end{tabular}
\end{center}
\caption{可以用作流程图的表格}
\label{tab:SpareseRep}
\end{table}

同时跨行跨列的表格（\ref{tab:confusionmatrix}）：
\begin{table}[htbp]
\centering
\begin{tabular}{rcccc}
    \toprule
    \multicolumn{2}{c}{\multirow{2}[2]{*}{Outcome}} & \multicolumn{2}{c}{Observed} & \\
    \multicolumn{2}{c}{} & Death  & Survivor \\
    \cline{3-5}
    \multirow{2}[4]{*}{Predicted} & Death & TP   & FP \\
    \cline{3-5}
          & Survivor & FN   & TN \\
   \bottomrule
\end{tabular}
\caption{同时跨行跨列的表格}
\label{tab:confusionmatrix}
\end{table}


\section{图片}
单幅图片（\ref{fig:histogram}）和多幅图片（\ref{fig:ROC}）
\begin{figure}[htbp]
\begin{center}
	\includegraphics[width=0.8\linewidth]{histogram.eps}
\end{center}
\caption{单幅图片}
\label{fig:histogram}
\end{figure}

\begin{figure}
\begin{center}
\subfloat[年龄的ROC曲线]{
\includegraphics[width=0.5\textwidth]{Fig_A.eps}}
\subfloat[体重的ROC曲线]{
\includegraphics[width=0.5\linewidth]{Fig_B.eps}}\\
\subfloat[年龄频率分布直方图]{
\includegraphics[width=0.5\textwidth]{Fig_C.eps}}
\subfloat[体重频率分布直方图]{
\includegraphics[width=0.5\linewidth]{Fig_D.eps}}
\end{center}
\caption{多幅图片}
\label{fig:ROC}
\end{figure}

\chapter{关于参考文献}
所有参考文献的条目都在文件refs.bib中。新建参考文献的最简单方法，就是利用Google Scholar提供的“导入BibTeX”功能。

\begin{figure}[htbp]
\begin{center}
	\includegraphics[width=0.8\linewidth]{google.jpg}
\end{center}
\caption{Google Scholar的导入BibTeX功能}
\label{fig:google}
\end{figure}

\cite{knaus1981apache}、\cite{website:challenge}、\cite{hug2009icu} 和\cite{jobson2005applied}分别给出了期刊论文、网址、会议合集论文以及书籍的
参考文献引用格式。

\chapter{写在最后}
由于模板使用了书籍排版的基本样式，所以在一个章节末尾的双数页可能会是空白页，这适合于双面打印。如果你想去掉空白页，简单的办法是直接在Adobe Acrobat中删除页面。而如果您想大修此模板，请阅读和修改文件ZJUthesis.cls和ZJUthesis.cfg。

作为一名不到一个月就要毕业的光电大四同学，这份模板就算是临走前送给学弟学妹的一个礼物吧。由于本人也是\LaTeX菜鸟，水平有限，所以模板中还有一些
Bug不能更正，而且格式上和系里提供的WORD模板还有些出入。在这里抛砖引玉，
只是希望更多真正懂\LaTeX的同学能把它完善，从而使大家受益{\LARGE{\Smiley}}。
\fi
